<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">

	<title>MPSImage Class Reference</title>

	<link rel="stylesheet" href="../css/style.css">
	<meta name="viewport" content="initial-scale=1, maximum-scale=1.4">
	<meta name="generator" content="appledoc 2.2.1 (build 1334)">
</head>
<body class="appledoc">
	<header>
		<div class="container" class="hide-in-xcode">
			
			<h1 id="library-title">
				<a href="../index.html">MacOSX 10.13 MetalPerformanceShaders Framework </a>
			</h1>

			<p id="developer-home">
				<a href="../index.html">Apple Inc.</a>
			</p>
			
		</div>
	</header>

	<aside>
		<div class="container">
			<nav>
				<ul id="header-buttons" role="toolbar">
					<li><a href="../index.html">Index</a></li>
<li><a href="../hierarchy.html">Hierarchy</a></li>

					<li id="on-this-page" role="navigation">
						<label>
							On This Page

							<div class="chevron">
								<div class="chevy chevron-left"></div>
								<div class="chevy chevron-right"></div>
							</div>

							<select id="jump-to">
	<option value="top">Jump To&#133;</option>
	
	<option value="overview">Overview</option>
	

	
	
	<option value="tasks">Tasks</option>
	
	

	
	
	<optgroup label="Properties">
		
		<option value="//api/name/device">device</option>
		
		<option value="//api/name/featureChannels">featureChannels</option>
		
		<option value="//api/name/height">height</option>
		
		<option value="//api/name/label">label</option>
		
		<option value="//api/name/numberOfImages">numberOfImages</option>
		
		<option value="//api/name/pixelFormat">pixelFormat</option>
		
		<option value="//api/name/pixelSize">pixelSize</option>
		
		<option value="//api/name/precision">precision</option>
		
		<option value="//api/name/texture">texture</option>
		
		<option value="//api/name/textureType">textureType</option>
		
		<option value="//api/name/usage">usage</option>
		
		<option value="//api/name/width">width</option>
		
	</optgroup>
	

	
	<optgroup label="Class Methods">
		
		<option value="//api/name/defaultAllocator">+ defaultAllocator</option>
		
	</optgroup>
	

	
	<optgroup label="Instance Methods">
		
		<option value="//api/name/init">- init</option>
		
		<option value="//api/name/initWithDevice:imageDescriptor:">- initWithDevice:imageDescriptor:</option>
		
		<option value="//api/name/initWithTexture:featureChannels:">- initWithTexture:featureChannels:</option>
		
		<option value="//api/name/readBytes:dataLayout:bytesPerRow:region:featureChannelInfo:imageIndex:">- readBytes:dataLayout:bytesPerRow:region:featureChannelInfo:imageIndex:</option>
		
		<option value="//api/name/readBytes:dataLayout:imageIndex:">- readBytes:dataLayout:imageIndex:</option>
		
		<option value="//api/name/setPurgeableState:">- setPurgeableState:</option>
		
		<option value="//api/name/writeBytes:dataLayout:bytesPerRow:region:featureChannelInfo:imageIndex:">- writeBytes:dataLayout:bytesPerRow:region:featureChannelInfo:imageIndex:</option>
		
		<option value="//api/name/writeBytes:dataLayout:imageIndex:">- writeBytes:dataLayout:imageIndex:</option>
		
	</optgroup>
	
	
</select>
						</label>
					</li>
				</ul>
			</nav>
		</div>
	</aside>

	<article>
		<div id="overview_contents" class="container">
			<div id="content">
				<main role="main">
					<h1 class="title">MPSImage Class Reference</h1>

					
					<div class="section section-specification"><table cellspacing="0"><tbody>
						<tr>
	<th>Inherits from</th>
	<td>NSObject</td>
</tr><tr>
	<th>Declared in</th>
	<td>MPSImage.h</td>
</tr>
						</tbody></table></div>
					

                    
					
					<div class="section section-overview">
						<a title="Overview" name="overview"></a>
						<h2 class="subtitle subtitle-overview">Overview</h2>
						<p>@class      MPSImage
@dependency This depends on Metal.framework</p><p>Some image types, such as those found in convolutional neural networks (CNN)
differ from a standard <a href="#//api/name/texture">texture</a> in that they may have more than 4 channels
per image. While the channels could hold RGBA data, they will more commonly
hold a number of structural permutations upon a multi-channel image as the neural
network progresses. It is not uncommon for each pixel to have 32 or 64 channels
in it.</p>

<p>A standard MTLTexture may have no more than 4 channels. The additional
channels are stored in slices of 2d <a href="#//api/name/texture">texture</a> array (i.e. <a href="#//api/name/texture">texture</a> type is MTLTextureType2DArray)
such that 4 consecutive channels are stored in each slice of this array.
If the number of feature channels is N, number of array slices needed is (N+3)/4.
E.g. a CNN image with <a href="#//api/name/width">width</a> 3 and <a href="#//api/name/height">height</a> 2 with 9 channels will be stored as
```
slice 0   RGBA   RGBA  RGBA
RGBA   RGBA  RGBA</p>

<p>slice 1      RGBA   RGBA   RGBA
RGBA   RGBA   RGBA         (ASCII art /diagonal offset/ intended to show a Z dimension)</p>

<p>slice 2         R???   R???   R???
R???   R???   R???
```
The width and height of underlying 2d texture array is the same as the width and height of the MPSImage.
The array length is equal to (featureChannels + 3) / 4. Channels marked with ? are just
for padding and should not contain NaNs or Infs.</p>

<p>A MPSImage can be container of multiple CNN images for batch processing. In order to create a
MPSImage that contains N images, create MPSImageDescriptor with numberOfImages set to N.</p>

<p>Although a MPSImage can contain numberOfImages > 1, the actual number of images among these processed by MPSCNNKernel
is controlled by z-dimension of the clipRect. A MPSCNNKernel processes n=clipRect.size.depth images from this collection.
The starting source image index to process is given by offset.z. The starting index of the destination image is given by
clipRect.origin.z. The MPSCNNKernel takes n=clipRect.size.depth images from tje source at indices [offset.z, offset.z+n],
processes each independently and stores the result in the destination at indices [clipRect.origin.z, clipRect.origin.z+n]
respectively. Offset.z+n should be &lt;= [src numberOfImage] and clipRect.origin.z+n should be &lt;= [dest numberOfImages] and
offset.z must be >= 0.</p>

<p>Example: Suppose <a href="../Classes/MPSCNNConvolution.html">MPSCNNConvolution</a> takes an input image with 8 channels and outputs an image with 16 channels. The number of
slices needed in the source 2d <a href="#//api/name/texture">texture</a> array is 2 and the number of slices needed in the destination 2d array is 4. Suppose
the source batch size is 5 and destination batch size is 4. (Multiple N-channel images can be processed concurrently in a
batch.) The number of source slices will be 2<em>5=10 and number of destination slices will be 4</em>4=16. If you want to process
just images 2 and 3 of the source and store the result at index 1 and 2 in the destination, you may achieve this by setting
offset.z=2, clipRect.origin.z=1 and clipRect.size.depth=2. <a href="../Classes/MPSCNNConvolution.html">MPSCNNConvolution</a> will take, in this case, slice 4 and 5 of source and
produce slices 4 to 7 of destination. Similarly, slices 6 and 7 will be used to produce slices 8 to 11 of destination.</p>

<p>All MPSCNNKernels process images within each batch independently. That is, calling a <a href="../Classes/MPSCNNKernel.html">MPSCNNKernel</a> on an
batch is formally the same as calling it on each image in the batch one at a time. However, quite a lot of CPU and GPU overhead
will be avoided if batch processing is used. This is especially important for better performance on small images.</p>

<p>If the number of feature channels is &lt;= 4 and <a href="#//api/name/numberOfImages">numberOfImages</a> = 1 i.e. only one slice is needed to represent a MPSImage, the underlying
metal <a href="#//api/name/texture">texture</a> type will be MTLTextureType2D rather than MTLTextureType2DArray.</p>

<p>There are also MPSTemporaryImages, intended for use for very short-lived image data that are produced and consumed
immediately in the same MTLCommandBuffer. They are a useful way to minimize CPU-side <a href="#//api/name/texture">texture</a> allocation costs and
greatly reduce the amount of memory used by your image pipeline.</p>

<p>Creation of the underlying <a href="#//api/name/texture">texture</a> may in some cases occur lazily.  You should
in general avoid calling MPSImage.<a href="#//api/name/texture">texture</a> except when unavoidable to avoid
materializing memory for longer than necessary. When possible, use the other MPSImage
properties to get information about the MPSImage instead.</p>

<p>Most MPSImages of 4 or fewer feature channels can generate quicklooks output in
Xcode for easy visualization of image data in the object. MPSTemporaryImages can not.</p>
					</div>
					
					

					
					
					<div class="section section-tasks">
						<a title="Tasks" name="tasks"></a>
						

						
						

						<div class="task-list">
							<div class="section-method">
	<a name="//api/name/defaultAllocator" title="defaultAllocator"></a>
	<h3 class="method-title"><code><a href="#//api/name/defaultAllocator">+&nbsp;defaultAllocator</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<pre><code> Get a well known MPSImageAllocator that makes MPSImages 
</code></pre>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>+ (nonnull id&lt;MPSImageAllocator&gt;)defaultAllocator</code></div>

		    
			

			

			

			
			<div class="method-subsection discussion-section">
				<h4 class="method-subtitle">Discussion</h4>
				<pre><code> Get a well known MPSImageAllocator that makes MPSImages 
</code></pre>
			</div>
			

			

			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">MPSImage.h</code></p>
			</div>
			
			
		</div>
	</div>
</div><div class="section-method">
	<a name="//api/name/device" title="device"></a>
	<h3 class="method-title"><code><a href="#//api/name/device">&nbsp;&nbsp;device</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<p>The device on which the MPSImage will be used</p>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>@property (readonly, retain, nonatomic, nonnull) id&lt;MTLDevice&gt; device</code></div>

		    
			

			

			

			
			<div class="method-subsection discussion-section">
				<h4 class="method-subtitle">Discussion</h4>
				<p>@property device</p>
			</div>
			

			

			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">MPSImage.h</code></p>
			</div>
			
			
		</div>
	</div>
</div><div class="section-method">
	<a name="//api/name/width" title="width"></a>
	<h3 class="method-title"><code><a href="#//api/name/width">&nbsp;&nbsp;width</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<p>The formal width of the image in pixels.</p>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>@property (readonly, nonatomic) NSUInteger width</code></div>

		    
			

			

			

			
			<div class="method-subsection discussion-section">
				<h4 class="method-subtitle">Discussion</h4>
				<p>@property   width</p>
			</div>
			

			

			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">MPSImage.h</code></p>
			</div>
			
			
		</div>
	</div>
</div><div class="section-method">
	<a name="//api/name/height" title="height"></a>
	<h3 class="method-title"><code><a href="#//api/name/height">&nbsp;&nbsp;height</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<p>The formal height of the image in pixels.</p>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>@property (readonly, nonatomic) NSUInteger height</code></div>

		    
			

			

			

			
			<div class="method-subsection discussion-section">
				<h4 class="method-subtitle">Discussion</h4>
				<p>@property   height</p>
			</div>
			

			

			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">MPSImage.h</code></p>
			</div>
			
			
		</div>
	</div>
</div><div class="section-method">
	<a name="//api/name/featureChannels" title="featureChannels"></a>
	<h3 class="method-title"><code><a href="#//api/name/featureChannels">&nbsp;&nbsp;featureChannels</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<p>The number of feature channels per pixel.</p>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>@property (readonly, nonatomic) NSUInteger featureChannels</code></div>

		    
			

			

			

			
			<div class="method-subsection discussion-section">
				<h4 class="method-subtitle">Discussion</h4>
				<p>@property   featureChannels</p>
			</div>
			

			

			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">MPSImage.h</code></p>
			</div>
			
			
		</div>
	</div>
</div><div class="section-method">
	<a name="//api/name/numberOfImages" title="numberOfImages"></a>
	<h3 class="method-title"><code><a href="#//api/name/numberOfImages">&nbsp;&nbsp;numberOfImages</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<p>numberOfImages for batch processing</p>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>@property (readonly, nonatomic) NSUInteger numberOfImages</code></div>

		    
			

			

			

			
			<div class="method-subsection discussion-section">
				<h4 class="method-subtitle">Discussion</h4>
				<p>@property   numberOfImages</p>
			</div>
			

			

			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">MPSImage.h</code></p>
			</div>
			
			
		</div>
	</div>
</div><div class="section-method">
	<a name="//api/name/textureType" title="textureType"></a>
	<h3 class="method-title"><code><a href="#//api/name/textureType">&nbsp;&nbsp;textureType</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<p>The type of the underlying <a href="#//api/name/texture">texture</a>, typically MTLTextureType2D
or MTLTextureType2DArray</p>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>@property (readonly, nonatomic) MTLTextureType textureType</code></div>

		    
			

			

			

			
			<div class="method-subsection discussion-section">
				<h4 class="method-subtitle">Discussion</h4>
				<p>@property   textureType</p>
			</div>
			

			

			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">MPSImage.h</code></p>
			</div>
			
			
		</div>
	</div>
</div><div class="section-method">
	<a name="//api/name/pixelFormat" title="pixelFormat"></a>
	<h3 class="method-title"><code><a href="#//api/name/pixelFormat">&nbsp;&nbsp;pixelFormat</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<p>The MTLPixelFormat of the underlying <a href="#//api/name/texture">texture</a></p>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>@property (readonly, nonatomic) MTLPixelFormat pixelFormat</code></div>

		    
			

			

			

			
			<div class="method-subsection discussion-section">
				<h4 class="method-subtitle">Discussion</h4>
				<p>@property   pixelFormat</p>
			</div>
			

			

			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">MPSImage.h</code></p>
			</div>
			
			
		</div>
	</div>
</div><div class="section-method">
	<a name="//api/name/precision" title="precision"></a>
	<h3 class="method-title"><code><a href="#//api/name/precision">&nbsp;&nbsp;precision</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<p>The number of bits of numeric precision available for each feature channel.</p>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>@property (readonly, nonatomic) NSUInteger precision</code></div>

		    
			

			

			

			
			<div class="method-subsection discussion-section">
				<h4 class="method-subtitle">Discussion</h4>
				<p>@property   precision</p><p>This is precision, not size.  That is, float is 24 bits, not 32. half
precision floating-point is 11 bits, not 16. SNorm formats have one less
bit of precision for the sign bit, etc. For formats like MTLPixelFormatB5G6R5Unorm
it is the precision of the most precise channel, in this case 6.  When this
information is unavailable, typically compressed formats, 0 will be returned.</p>
			</div>
			

			

			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">MPSImage.h</code></p>
			</div>
			
			
		</div>
	</div>
</div><div class="section-method">
	<a name="//api/name/usage" title="usage"></a>
	<h3 class="method-title"><code><a href="#//api/name/usage">&nbsp;&nbsp;usage</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<p>Description of <a href="#//api/name/texture">texture</a> usage.</p>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>@property (readonly, nonatomic) MTLTextureUsage usage</code></div>

		    
			

			

			

			
			<div class="method-subsection discussion-section">
				<h4 class="method-subtitle">Discussion</h4>
				<p>@property   usage</p>
			</div>
			

			

			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">MPSImage.h</code></p>
			</div>
			
			
		</div>
	</div>
</div><div class="section-method">
	<a name="//api/name/pixelSize" title="pixelSize"></a>
	<h3 class="method-title"><code><a href="#//api/name/pixelSize">&nbsp;&nbsp;pixelSize</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<p>Number of bytes from the first byte of one pixel to the first byte of the next
pixel in storage order.  (Includes padding.)</p>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>@property (readonly, nonatomic) size_t pixelSize</code></div>

		    
			

			

			

			
			<div class="method-subsection discussion-section">
				<h4 class="method-subtitle">Discussion</h4>
				<p>@property   pixelSize</p>
			</div>
			

			

			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">MPSImage.h</code></p>
			</div>
			
			
		</div>
	</div>
</div><div class="section-method">
	<a name="//api/name/texture" title="texture"></a>
	<h3 class="method-title"><code><a href="#//api/name/texture">&nbsp;&nbsp;texture</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<p>The associated MTLTexture object.
This is a 2D texture if <a href="#//api/name/numberOfImages">numberOfImages</a> is 1 and number of feature channels &lt;= 4.
It is a 2D texture array otherwise.</p>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>@property (readonly, nonnull, nonatomic) id&lt;MTLTexture&gt; texture</code></div>

		    
			

			

			

			
			<div class="method-subsection discussion-section">
				<h4 class="method-subtitle">Discussion</h4>
				<p>@property   texture</p><p>To avoid the high cost of premature allocation of the underlying texture, avoid calling this
property except when strictly necessary. [MPSCNNKernel encode&hellip;] calls typically cause
their arguments to become allocated. Likewise, MPSImages initialized with -initWithTexture:
featureChannels: have already been allocated.</p>
			</div>
			

			

			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">MPSImage.h</code></p>
			</div>
			
			
		</div>
	</div>
</div><div class="section-method">
	<a name="//api/name/label" title="label"></a>
	<h3 class="method-title"><code><a href="#//api/name/label">&nbsp;&nbsp;label</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<p>A string to help identify this object.</p>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>@property (copy, atomic, nullable) NSString *label</code></div>

		    
			

			

			

			
			<div class="method-subsection discussion-section">
				<h4 class="method-subtitle">Discussion</h4>
				<p>@property label</p>
			</div>
			

			

			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">MPSImage.h</code></p>
			</div>
			
			
		</div>
	</div>
</div><div class="section-method">
	<a name="//api/name/initWithDevice:imageDescriptor:" title="initWithDevice:imageDescriptor:"></a>
	<h3 class="method-title"><code><a href="#//api/name/initWithDevice:imageDescriptor:">&ndash;&nbsp;initWithDevice:imageDescriptor:</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<p>Initialize an empty image object</p>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>- (nonnull instancetype)initWithDevice:(nonnull id&lt;MTLDevice&gt;)<em>device</em> imageDescriptor:(const MPSImageDescriptor *__nonnull)<em>imageDescriptor</em></code></div>

		    
			
			<div class="method-subsection arguments-section parameters">
				<h4 class="method-subtitle parameter-title">Parameters</h4>
				<table class="argument-def parameter-def">
				
					<tr>
						<th scope="row" class="argument-name"><code>device</code></th>
						<td><p>The <a href="#//api/name/device">device</a> that the image will be used. May not be NULL.</p></td>
					</tr>
				
					<tr>
						<th scope="row" class="argument-name"><code>imageDescriptor</code></th>
						<td><p>The <a href="../Classes/MPSImageDescriptor.html">MPSImageDescriptor</a>. May not be NULL.</p></td>
					</tr>
				
				</table>
			</div>
			

			
			<div class="method-subsection return">
				<h4 class="method-subtitle parameter-title">Return Value</h4>
				<p>A valid MPSImage object or nil, if failure.</p>
			</div>
			

			

			
			<div class="method-subsection discussion-section">
				<h4 class="method-subtitle">Discussion</h4>
				<p>Storage to store data needed is allocated lazily on first use of MPSImage or
when application calls MPSImage.<a href="#//api/name/texture">texture</a></p>
			</div>
			

			

			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">MPSImage.h</code></p>
			</div>
			
			
		</div>
	</div>
</div><div class="section-method">
	<a name="//api/name/initWithTexture:featureChannels:" title="initWithTexture:featureChannels:"></a>
	<h3 class="method-title"><code><a href="#//api/name/initWithTexture:featureChannels:">&ndash;&nbsp;initWithTexture:featureChannels:</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<p>Initialize an MPSImage object using Metal <a href="#//api/name/texture">texture</a>. Metal <a href="#//api/name/texture">texture</a> has been created by
user for specific number of feature channels and number of images.</p>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>- (nonnull instancetype)initWithTexture:(nonnull id&lt;MTLTexture&gt;)<em>texture</em> featureChannels:(NSUInteger)<em>featureChannels</em></code></div>

		    
			
			<div class="method-subsection arguments-section parameters">
				<h4 class="method-subtitle parameter-title">Parameters</h4>
				<table class="argument-def parameter-def">
				
					<tr>
						<th scope="row" class="argument-name"><code>texture</code></th>
						<td><p>The MTLTexture allocated by the user to be used as backing for MPSImage.</p></td>
					</tr>
				
					<tr>
						<th scope="row" class="argument-name"><code>featureChannels</code></th>
						<td><p>Number of feature channels this <a href="#//api/name/texture">texture</a> contains.</p></td>
					</tr>
				
				</table>
			</div>
			

			
			<div class="method-subsection return">
				<h4 class="method-subtitle parameter-title">Return Value</h4>
				<p>A valid MPSImage object or nil, if failure.</p>
			</div>
			

			

			
			<div class="method-subsection discussion-section">
				<h4 class="method-subtitle">Discussion</h4>
				<p>Application can let MPS framework allocate <a href="#//api/name/texture">texture</a> with properties specified in imageDescriptor
using initWithDevice:<a href="../Classes/MPSImageDescriptor.html">MPSImageDescriptor</a> API above. However in memory intensive application,
you can save memory (and allocation/deallocation time) by using <a href="../Classes/MPSTemporaryImage.html">MPSTemporaryImage</a> where MPS
framework aggressively reuse memory underlying textures on same command buffer. See <a href="../Classes/MPSTemporaryImage.html">MPSTemporaryImage</a>
class for details below. However, in certain cases, application developer may want more control
on allocation, placement, reusing/recycling of memory backing textures used in application using
Metal Heaps API. In this case, application can create MPSImage from pre-allocated <a href="#//api/name/texture">texture</a> using
initWithTexture:<a href="#//api/name/featureChannels">featureChannels</a>.</p>

<p>MTLTextureType of <a href="#//api/name/texture">texture</a> can be MTLTextureType2D ONLY if <a href="#//api/name/featureChannels">featureChannels</a> &lt;= 4 in which case
MPSImage.<a href="#//api/name/numberOfImages">numberOfImages</a> is set to 1. Else it should be MTLTextureType2DArray with
arrayLength == numberOfImage * ((<a href="#//api/name/featureChannels">featureChannels</a> + 3)/4). MPSImage.<a href="#//api/name/numberOfImages">numberOfImages</a> is set to
<a href="#//api/name/texture">texture</a>.arrayLength / ((<a href="#//api/name/featureChannels">featureChannels</a> + 3)/4).</p>

<p>For MTLTextures containing typical image data which application may obtain from MetalKit or
other libraries such as that drawn from a JPEG or PNG, <a href="#//api/name/featureChannels">featureChannels</a> should
be set to number of valid color channel e.g. for RGB data, even thought MTLPixelFormat will be
MTLPixelFormatRGBA, <a href="#//api/name/featureChannels">featureChannels</a> should be set to 3.</p>
			</div>
			

			

			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">MPSImage.h</code></p>
			</div>
			
			
		</div>
	</div>
</div><div class="section-method">
	<a name="//api/name/init" title="init"></a>
	<h3 class="method-title"><code><a href="#//api/name/init">&ndash;&nbsp;init</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			

			<div class="method-subsection method-declaration"><code>- (nonnull instancetype)init</code></div>

		    
		</div>
	</div>
</div><div class="section-method">
	<a name="//api/name/setPurgeableState:" title="setPurgeableState:"></a>
	<h3 class="method-title"><code><a href="#//api/name/setPurgeableState:">&ndash;&nbsp;setPurgeableState:</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<p>Set (or query) the purgeability state of a MPSImage</p>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>- (MPSPurgeableState)setPurgeableState:(MPSPurgeableState)<em>state</em></code></div>

		    
			

			

			

			
			<div class="method-subsection discussion-section">
				<h4 class="method-subtitle">Discussion</h4>
				<p>@method         setPurgeableState</p><p>Usage is per [MTLResource setPurgeableState:], except that the MTLTexture might be
MPSPurgeableStateAllocationDeferred, which means there is no <a href="#//api/name/texture">texture</a> to mark volatile / nonvolatile.
Attempts to set purgeability on MTLTextures that have not been allocated will be ignored.</p>
			</div>
			

			

			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">MPSImage.h</code></p>
			</div>
			
			
		</div>
	</div>
</div><div class="section-method">
	<a name="//api/name/readBytes:dataLayout:bytesPerRow:region:featureChannelInfo:imageIndex:" title="readBytes:dataLayout:bytesPerRow:region:featureChannelInfo:imageIndex:"></a>
	<h3 class="method-title"><code><a href="#//api/name/readBytes:dataLayout:bytesPerRow:region:featureChannelInfo:imageIndex:">&ndash;&nbsp;readBytes:dataLayout:bytesPerRow:region:featureChannelInfo:imageIndex:</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<p>Get the values inside MPSImage and put them in the Buffer passed in.</p>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>- (void)readBytes:(void *__nonnull)<em>dataBytes</em> dataLayout:(MPSDataLayout)<em>dataLayout</em> bytesPerRow:(NSUInteger)<em>bytesPerRow</em> region:(MTLRegion)<em>region</em> featureChannelInfo:(MPSImageReadWriteParams)<em>featureChannelInfo</em> imageIndex:(NSUInteger)<em>imageIndex</em></code></div>

		    
			
			<div class="method-subsection arguments-section parameters">
				<h4 class="method-subtitle parameter-title">Parameters</h4>
				<table class="argument-def parameter-def">
				
					<tr>
						<th scope="row" class="argument-name"><code>dataBytes</code></th>
						<td><p>The array allocated by the user to be used to put data from MPSImage, the length should be
imageWidth * imageHeight * numberOfFeatureChannels and dataType should be inferred from <a href="#//api/name/pixelFormat">pixelFormat</a>
defined in the Image Descriptor.</p></td>
					</tr>
				
					<tr>
						<th scope="row" class="argument-name"><code>dataLayout</code></th>
						<td><p>The enum tells how to layout MPS data in the buffer.</p></td>
					</tr>
				
					<tr>
						<th scope="row" class="argument-name"><code>bytesPerRow</code></th>
						<td><p>Bytes to stride to point to next row(pixel just below current one) in the user buffer.</p></td>
					</tr>
				
					<tr>
						<th scope="row" class="argument-name"><code>region</code></th>
						<td><p>region of the MPSImage to read from. A region is a structure with the origin in the Image from which to start
reading values and a size which represents the <a href="#//api/name/width">width</a> and <a href="#//api/name/height">height</a> of the rectangular region to read from.
The z direction denotes the number of images, thus for 1 image, origin.z = 0 and size.depth = 1</p></td>
					</tr>
				
					<tr>
						<th scope="row" class="argument-name"><code>featureChannelInfo</code></th>
						<td><p>information user fills in to write to a set of feature channels in the image</p></td>
					</tr>
				
					<tr>
						<th scope="row" class="argument-name"><code>imageIndex</code></th>
						<td><p>Image index in MPSImage to write to.</p></td>
					</tr>
				
				</table>
			</div>
			

			

			

			
			<div class="method-subsection discussion-section">
				<h4 class="method-subtitle">Discussion</h4>
				<p>@method         readBytes</p><p>Use the enum to set data is coming in with what order. The data type will be determined by the <a href="#//api/name/pixelFormat">pixelFormat</a>
defined in the Image Descriptor.</p>
			</div>
			

			

			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">MPSImage.h</code></p>
			</div>
			
			
		</div>
	</div>
</div><div class="section-method">
	<a name="//api/name/writeBytes:dataLayout:bytesPerRow:region:featureChannelInfo:imageIndex:" title="writeBytes:dataLayout:bytesPerRow:region:featureChannelInfo:imageIndex:"></a>
	<h3 class="method-title"><code><a href="#//api/name/writeBytes:dataLayout:bytesPerRow:region:featureChannelInfo:imageIndex:">&ndash;&nbsp;writeBytes:dataLayout:bytesPerRow:region:featureChannelInfo:imageIndex:</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<p>Set the values inside MPSImage with the Buffer passed in.</p>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>- (void)writeBytes:(const void *__nonnull)<em>dataBytes</em> dataLayout:(MPSDataLayout)<em>dataLayout</em> bytesPerRow:(NSUInteger)<em>bytesPerRow</em> region:(MTLRegion)<em>region</em> featureChannelInfo:(MPSImageReadWriteParams)<em>featureChannelInfo</em> imageIndex:(NSUInteger)<em>imageIndex</em></code></div>

		    
			
			<div class="method-subsection arguments-section parameters">
				<h4 class="method-subtitle parameter-title">Parameters</h4>
				<table class="argument-def parameter-def">
				
					<tr>
						<th scope="row" class="argument-name"><code>dataBytes</code></th>
						<td><p>The array allocated by the user to be used to put data from MPSImage, the length should be
imageWidth * imageHeight * numberOfFeatureChannels and dataType should be inferred from <a href="#//api/name/pixelFormat">pixelFormat</a>
defined in the Image Descriptor.</p></td>
					</tr>
				
					<tr>
						<th scope="row" class="argument-name"><code>dataLayout</code></th>
						<td><p>The enum tells how to layout MPS data in the buffer.</p></td>
					</tr>
				
					<tr>
						<th scope="row" class="argument-name"><code>bytesPerRow</code></th>
						<td><p>Bytes to stride to point to next row(pixel just below current one) in the user buffer.</p></td>
					</tr>
				
					<tr>
						<th scope="row" class="argument-name"><code>region</code></th>
						<td><p>region of the MPSImage to write to. A region is a structure with the origin in the Image from which to start
writing values and a size which represents the <a href="#//api/name/width">width</a> and <a href="#//api/name/height">height</a> of the rectangular region to write in.
The z direction denotes the number of images, thus for 1 image, origin.z = 0 and size.depth = 1</p></td>
					</tr>
				
					<tr>
						<th scope="row" class="argument-name"><code>featureChannelInfo</code></th>
						<td><p>information user fills in to read from a set of feature channels in the image</p></td>
					</tr>
				
					<tr>
						<th scope="row" class="argument-name"><code>imageIndex</code></th>
						<td><p>Image index in MPSImage to write to.</p></td>
					</tr>
				
				</table>
			</div>
			

			

			

			
			<div class="method-subsection discussion-section">
				<h4 class="method-subtitle">Discussion</h4>
				<p>@method         writeBytes</p><p>Use the enum to set data is coming in with what order. The data type will be determined by the <a href="#//api/name/pixelFormat">pixelFormat</a>
defined in the Image Descriptor.</p>
			</div>
			

			

			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">MPSImage.h</code></p>
			</div>
			
			
		</div>
	</div>
</div><div class="section-method">
	<a name="//api/name/readBytes:dataLayout:imageIndex:" title="readBytes:dataLayout:imageIndex:"></a>
	<h3 class="method-title"><code><a href="#//api/name/readBytes:dataLayout:imageIndex:">&ndash;&nbsp;readBytes:dataLayout:imageIndex:</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<p>Get the values inside MPSImage and put them in the Buffer passed in.</p>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>- (void)readBytes:(void *__nonnull)<em>dataBytes</em> dataLayout:(MPSDataLayout)<em>dataLayout</em> imageIndex:(NSUInteger)<em>imageIndex</em></code></div>

		    
			
			<div class="method-subsection arguments-section parameters">
				<h4 class="method-subtitle parameter-title">Parameters</h4>
				<table class="argument-def parameter-def">
				
					<tr>
						<th scope="row" class="argument-name"><code>dataBytes</code></th>
						<td><p>The array allocated by the user to be used to put data from MPSImage, the length should be
imageWidth * imageHeight * numberOfFeatureChannels and dataType should be inferred from <a href="#//api/name/pixelFormat">pixelFormat</a>
defined in the Image Descriptor.</p></td>
					</tr>
				
					<tr>
						<th scope="row" class="argument-name"><code>dataLayout</code></th>
						<td><p>The enum tells how to layout MPS data in the buffer.</p></td>
					</tr>
				
					<tr>
						<th scope="row" class="argument-name"><code>imageIndex</code></th>
						<td><p>Image index in MPSImage to read from.</p></td>
					</tr>
				
				</table>
			</div>
			

			

			

			
			<div class="method-subsection discussion-section">
				<h4 class="method-subtitle">Discussion</h4>
				<p>@method         readBytes</p><p>Use the enum to set data is coming in with what order. The data type will be determined by the <a href="#//api/name/pixelFormat">pixelFormat</a>
defined in the Image Descriptor. Region is full image, buffer <a href="#//api/name/width">width</a> and <a href="#//api/name/height">height</a> is same as MPSImage <a href="#//api/name/width">width</a> and <a href="#//api/name/height">height</a>.</p>
			</div>
			

			

			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">MPSImage.h</code></p>
			</div>
			
			
		</div>
	</div>
</div><div class="section-method">
	<a name="//api/name/writeBytes:dataLayout:imageIndex:" title="writeBytes:dataLayout:imageIndex:"></a>
	<h3 class="method-title"><code><a href="#//api/name/writeBytes:dataLayout:imageIndex:">&ndash;&nbsp;writeBytes:dataLayout:imageIndex:</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<p>Set the values inside MPSImage with the Buffer passed in.</p>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>- (void)writeBytes:(const void *__nonnull)<em>dataBytes</em> dataLayout:(MPSDataLayout)<em>dataLayout</em> imageIndex:(NSUInteger)<em>imageIndex</em></code></div>

		    
			
			<div class="method-subsection arguments-section parameters">
				<h4 class="method-subtitle parameter-title">Parameters</h4>
				<table class="argument-def parameter-def">
				
					<tr>
						<th scope="row" class="argument-name"><code>dataBytes</code></th>
						<td><p>The array allocated by the user to be used to put data from MPSImage, the length should be
imageWidth * imageHeight * numberOfFeatureChannels and dataType should be inferred from <a href="#//api/name/pixelFormat">pixelFormat</a>
defined in the Image Descriptor.</p></td>
					</tr>
				
					<tr>
						<th scope="row" class="argument-name"><code>dataLayout</code></th>
						<td><p>The enum tells how to layout MPS data in the buffer.</p></td>
					</tr>
				
					<tr>
						<th scope="row" class="argument-name"><code>imageIndex</code></th>
						<td><p>Image index in MPSImage to write to.</p></td>
					</tr>
				
				</table>
			</div>
			

			

			

			
			<div class="method-subsection discussion-section">
				<h4 class="method-subtitle">Discussion</h4>
				<p>@method         writeBytes</p><p>Use the enum to set data is coming in with what order. The data type will be determined by the <a href="#//api/name/pixelFormat">pixelFormat</a>
defined in the Image Descriptor. Region is full image, buffer <a href="#//api/name/width">width</a> and <a href="#//api/name/height">height</a> is same as MPSImage <a href="#//api/name/width">width</a> and <a href="#//api/name/height">height</a>.</p>
			</div>
			

			

			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">MPSImage.h</code></p>
			</div>
			
			
		</div>
	</div>
</div>
						</div>
						
					</div>
					
					

                    
                    
          
				</main>

				<footer>
					<div class="footer-copyright">
						
						<p class="copyright">Copyright &copy; 2018 Apple Inc. All rights reserved. Updated: 2018-03-06</p>
						
						
						<p class="generator">Generated by <a href="http://appledoc.gentlebytes.com">appledoc 2.2.1 (build 1334)</a>.</p>
						
					</div>
				</footer>
			</div>
		</div>
	</article>

	<script src="../js/script.js"></script>
</body>
</html>