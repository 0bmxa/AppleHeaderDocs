<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">

	<title>MPSCNNConvolutionTranspose Class Reference</title>

	<link rel="stylesheet" href="../css/style.css">
	<meta name="viewport" content="initial-scale=1, maximum-scale=1.4">
	<meta name="generator" content="appledoc 2.2.1 (build 1334)">
</head>
<body class="appledoc">
	<header>
		<div class="container" class="hide-in-xcode">
			
			<h1 id="library-title">
				<a href="../index.html">MacOSX 10.13 MetalPerformanceShaders Framework </a>
			</h1>

			<p id="developer-home">
				<a href="../index.html">Apple Inc.</a>
			</p>
			
		</div>
	</header>

	<aside>
		<div class="container">
			<nav>
				<ul id="header-buttons" role="toolbar">
					<li><a href="../index.html">Index</a></li>
<li><a href="../hierarchy.html">Hierarchy</a></li>

					<li id="on-this-page" role="navigation">
						<label>
							On This Page

							<div class="chevron">
								<div class="chevy chevron-left"></div>
								<div class="chevy chevron-right"></div>
							</div>

							<select id="jump-to">
	<option value="top">Jump To&#133;</option>
	
	<option value="overview">Overview</option>
	

	
	
	<option value="tasks">Tasks</option>
	
	

	
	
	<optgroup label="Properties">
		
		<option value="//api/name/groups">groups</option>
		
		<option value="//api/name/inputFeatureChannels">inputFeatureChannels</option>
		
		<option value="//api/name/kernelOffsetX">kernelOffsetX</option>
		
		<option value="//api/name/kernelOffsetY">kernelOffsetY</option>
		
		<option value="//api/name/outputFeatureChannels">outputFeatureChannels</option>
		
	</optgroup>
	

	

	
	<optgroup label="Instance Methods">
		
		<option value="//api/name/encodeToCommandBuffer:sourceImage:convolutionState:MPS_AVAILABLE_STARTING:">- encodeToCommandBuffer:sourceImage:convolutionState:MPS_AVAILABLE_STARTING:</option>
		
		<option value="//api/name/initWithCoder:device:">- initWithCoder:device:</option>
		
		<option value="//api/name/initWithDevice:">- initWithDevice:</option>
		
		<option value="//api/name/initWithDevice:weights:">- initWithDevice:weights:</option>
		
	</optgroup>
	
	
</select>
						</label>
					</li>
				</ul>
			</nav>
		</div>
	</aside>

	<article>
		<div id="overview_contents" class="container">
			<div id="content">
				<main role="main">
					<h1 class="title">MPSCNNConvolutionTranspose Class Reference</h1>

					
					<div class="section section-specification"><table cellspacing="0"><tbody>
						<tr>
	<th>Inherits from</th>
	<td><a href="../Classes/MPSCNNKernel.html">MPSCNNKernel</a> : <a href="../Classes/MPSKernel.html">MPSKernel</a> : NSObject</td>
</tr><tr>
	<th>Declared in</th>
	<td>MPSCNNConvolution.h</td>
</tr>
						</tbody></table></div>
					

                    
					
					<div class="section section-overview">
						<a title="Overview" name="overview"></a>
						<h2 class="subtitle subtitle-overview">Overview</h2>
						<p>@class      MPSCNNConvolutionTranspose
@dependency This depends on Metal.framework</p><p>The MPSCNNConvolutionTranspose specifies a transposed convolution.
The MPSCNNConvolutionTranspose convolves the input image with a set of filters, each producing one feature map in the output image.</p>

<p>Some third-party frameworks may rotate the weights spatially by 180 degrees for Convolution Transpose. MPS uses the weights
specified by the developer as-is and does not perform any rotation. The developer may need to rotate the weights appropriately
in case this rotation is needed before the convolution transpose is applied.</p>

<p>When the stride in any dimension is greater than 1, the convolution transpose puts (stride - 1) zeroes in-between the source
image pixels to create an expanded image. Then a convolution is done over the expanded image to generate the output of the
convolution transpose.</p>

<p>Intermediate image size = (srcSize - 1) * Stride + 1</p>

<p>Examples:</p>

<p>@code
So in case of sride == 2 (this behaves same in both dimensions)</p>

<p>Source image:</p>

<hr />

<p>|   |   |   |   |
| 1 | 2 | 3 | 4 |</p>

<h2>|   |   |   |   |</h2>

<p>Intermediate Image:</p>

<hr />

<p>|   |   |   |   |   |   |   |
| 1 | 0 | 2 | 0 | 3 | 0 | 4 |</p>

<h2>|   |   |   |   |   |   |   |</h2>

<p>NOTE on Offset:
There are 2 types of offsets defined:
1) The Offset defined in <a href="../Classes/MPSCNNKernel.html">MPSCNNKernel</a> from which MPSCNNConvolutionTranspose inherits. This offset is applied to from where
the kernel will be applied on the source.
2) The <a href="#//api/name/kernelOffsetX">kernelOffsetX</a> and <a href="#//api/name/kernelOffsetY">kernelOffsetY</a> which is the offset applied to the kernel when it is finally applied on the intermediate
image.</p>

<p>So totalOffset = Offset * stride + kernelOffset</p>

<p>The offset defined by user refers to the coordinate frame of the expanded image
(we are showing only 1 dimension X it can be extended to Y dimension as well) :</p>

<p>X indicates where the convolution transpose begins:</p>

<p>Intermediate Image:  Offset = 0, kernelOffset = 0</p>

<hr />

<p>|   |   |   |   |   |   |   |
| 1 | 0 | 2 | 0 | 3 | 0 | 4 |</p>

<h2>| X |   |   |   |   |   |   |</h2>

<p>X indicates where the convolution transpose begins:</p>

<p>Intermediate Image:  Offset = 0, kernelOffset = 1</p>

<hr />

<p>|   |   |   |   |   |   |   |
| 1 | 0 | 2 | 0 | 3 | 0 | 4 |</p>

<h2>|   | X |   |   |   |   |   |</h2>

<p>X indicates where the convolution transpose begins:</p>

<p>Intermediate Image:  Offset = 0, kernelOffset = -1</p>

<hr />

<p>|   |   |   |   |   |   |   |
X | 1 | 0 | 2 | 0 | 3 | 0 | 4 |</p>

<h2>|   |   |   |   |   |   |   |</h2>

<p>So if the user wanted to apply an offset of 2 on the source image of convolution transpose:</p>

<p>Source image:</p>

<hr />

<p>|   |   |   |   |
| 1 | 2 | 3 | 4 |</p>

<h2>|   |   | X |   |</h2>

<p>offset = 2, kernelOffset = 0</p>

<p>Intermediate Image:</p>

<hr />

<p>|   |   |   |   |   |   |   |
| 1 | 0 | 2 | 0 | 3 | 0 | 4 |</p>

<h2>|   |   |   |   | X |   |   |</h2>

<p>@endcode</p>
					</div>
					
					

					
					
					<div class="section section-tasks">
						<a title="Tasks" name="tasks"></a>
						

						
						

						<div class="task-list">
							<div class="section-method">
	<a name="//api/name/inputFeatureChannels" title="inputFeatureChannels"></a>
	<h3 class="method-title"><code><a href="#//api/name/inputFeatureChannels">&nbsp;&nbsp;inputFeatureChannels</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<p>The number of feature channels per pixel in the input image.</p>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>@property (readonly, nonatomic) NSUInteger inputFeatureChannels</code></div>

		    
			

			

			

			
			<div class="method-subsection discussion-section">
				<h4 class="method-subtitle">Discussion</h4>
				<p>@property   inputFeatureChannels</p>
			</div>
			

			

			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">MPSCNNConvolution.h</code></p>
			</div>
			
			
		</div>
	</div>
</div><div class="section-method">
	<a name="//api/name/outputFeatureChannels" title="outputFeatureChannels"></a>
	<h3 class="method-title"><code><a href="#//api/name/outputFeatureChannels">&nbsp;&nbsp;outputFeatureChannels</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<p>The number of feature channels per pixel in the output image.</p>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>@property (readonly, nonatomic) NSUInteger outputFeatureChannels</code></div>

		    
			

			

			

			
			<div class="method-subsection discussion-section">
				<h4 class="method-subtitle">Discussion</h4>
				<p>@property   outputFeatureChannels</p>
			</div>
			

			

			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">MPSCNNConvolution.h</code></p>
			</div>
			
			
		</div>
	</div>
</div><div class="section-method">
	<a name="//api/name/kernelOffsetX" title="kernelOffsetX"></a>
	<h3 class="method-title"><code><a href="#//api/name/kernelOffsetX">&nbsp;&nbsp;kernelOffsetX</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<p>Offset in X from which the kernel starts sliding</p>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>@property (readwrite, nonatomic) NSInteger kernelOffsetX</code></div>

		    
			

			

			

			
			<div class="method-subsection discussion-section">
				<h4 class="method-subtitle">Discussion</h4>
				<p>@property   kernelOffsetX</p>
			</div>
			

			

			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">MPSCNNConvolution.h</code></p>
			</div>
			
			
		</div>
	</div>
</div><div class="section-method">
	<a name="//api/name/kernelOffsetY" title="kernelOffsetY"></a>
	<h3 class="method-title"><code><a href="#//api/name/kernelOffsetY">&nbsp;&nbsp;kernelOffsetY</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<p>Offset in Y from which the kernel starts sliding</p>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>@property (readwrite, nonatomic) NSInteger kernelOffsetY</code></div>

		    
			

			

			

			
			<div class="method-subsection discussion-section">
				<h4 class="method-subtitle">Discussion</h4>
				<p>@property   kernelOffsetY</p>
			</div>
			

			

			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">MPSCNNConvolution.h</code></p>
			</div>
			
			
		</div>
	</div>
</div><div class="section-method">
	<a name="//api/name/groups" title="groups"></a>
	<h3 class="method-title"><code><a href="#//api/name/groups">&nbsp;&nbsp;groups</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<p>Number of groups input and output channels are divided into.</p>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>@property (readonly, nonatomic) NSUInteger groups</code></div>

		    
			

			

			

			
			<div class="method-subsection discussion-section">
				<h4 class="method-subtitle">Discussion</h4>
				<p>@property   groups</p>
			</div>
			

			

			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">MPSCNNConvolution.h</code></p>
			</div>
			
			
		</div>
	</div>
</div><div class="section-method">
	<a name="//api/name/initWithDevice:weights:" title="initWithDevice:weights:"></a>
	<h3 class="method-title"><code><a href="#//api/name/initWithDevice:weights:">&ndash;&nbsp;initWithDevice:weights:</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<p>Initializes a convolution transpose kernel</p>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>- (nonnull instancetype)initWithDevice:(nonnull id&lt;MTLDevice&gt;)<em>device</em> weights:(nonnull id&lt;MPSCNNConvolutionDataSource&gt;)<em>weights</em></code></div>

		    
			
			<div class="method-subsection arguments-section parameters">
				<h4 class="method-subtitle parameter-title">Parameters</h4>
				<table class="argument-def parameter-def">
				
					<tr>
						<th scope="row" class="argument-name"><code>device</code></th>
						<td><p>The MTLDevice on which this MPSCNNConvolutionTranspose filter will be used</p></td>
					</tr>
				
					<tr>
						<th scope="row" class="argument-name"><code>weights</code></th>
						<td><p>A pointer to a object that conforms to the <a href="../Protocols/MPSCNNConvolutionDataSource.html">MPSCNNConvolutionDataSource</a>
protocol. The <a href="../Protocols/MPSCNNConvolutionDataSource.html">MPSCNNConvolutionDataSource</a> protocol declares the methods that an
instance of MPSCNNConvolutionTranspose uses to obtain the weights and bias terms
for the CNN convolutionTranspose filter. Currently we support only Float32 weights.</p></td>
					</tr>
				
				</table>
			</div>
			

			
			<div class="method-subsection return">
				<h4 class="method-subtitle parameter-title">Return Value</h4>
				<p>A valid MPSCNNConvolutionTranspose object.</p>
			</div>
			

			

			

			

			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">MPSCNNConvolution.h</code></p>
			</div>
			
			
		</div>
	</div>
</div><div class="section-method">
	<a name="//api/name/initWithDevice:" title="initWithDevice:"></a>
	<h3 class="method-title"><code><a href="#//api/name/initWithDevice:">&ndash;&nbsp;initWithDevice:</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
		    

			<div class="method-subsection method-declaration"><code>- (nonnull instancetype)initWithDevice:(nonnull id&lt;MTLDevice&gt;)<em>device</em></code></div>

		    
			

			

			

			

			

			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">MPSCNNKernel.h</code></p>
			</div>
			
			
		</div>
	</div>
</div><div class="section-method">
	<a name="//api/name/initWithCoder:device:" title="initWithCoder:device:"></a>
	<h3 class="method-title"><code><a href="#//api/name/initWithCoder:device:">&ndash;&nbsp;initWithCoder:device:</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<p><NSSecureCoding> support</p>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>- (nullable instancetype)initWithCoder:(NSCoder *__nonnull)<em>aDecoder</em> device:(nonnull id&lt;MTLDevice&gt;)<em>device</em></code></div>

		    
			

			

			

			

			

			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">MPSCNNConvolution.h</code></p>
			</div>
			
			
		</div>
	</div>
</div><div class="section-method">
	<a name="//api/name/encodeToCommandBuffer:sourceImage:convolutionState:MPS_AVAILABLE_STARTING:" title="encodeToCommandBuffer:sourceImage:convolutionState:MPS_AVAILABLE_STARTING:"></a>
	<h3 class="method-title"><code><a href="#//api/name/encodeToCommandBuffer:sourceImage:convolutionState:MPS_AVAILABLE_STARTING:">&ndash;&nbsp;encodeToCommandBuffer:sourceImage:convolutionState:MPS_AVAILABLE_STARTING:</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<p>Encode a <a href="../Classes/MPSCNNKernel.html">MPSCNNKernel</a> into a command Buffer. Create a texture to hold the result and return it.</p>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>- (MPSImage *__nonnull)encodeToCommandBuffer:(nonnull id&lt;MTLCommandBuffer&gt;)<em>commandBuffer</em> sourceImage:(MPSImage *__nonnull)<em>sourceImage</em> convolutionState:(MPSCNNConvolutionState *__nullable)<em>convolutionState</em> MPS_AVAILABLE_STARTING</code></div>

		    
			
			<div class="method-subsection arguments-section parameters">
				<h4 class="method-subtitle parameter-title">Parameters</h4>
				<table class="argument-def parameter-def">
				
					<tr>
						<th scope="row" class="argument-name"><code>commandBuffer</code></th>
						<td><p>The command buffer</p></td>
					</tr>
				
					<tr>
						<th scope="row" class="argument-name"><code>sourceImage</code></th>
						<td><p>A <a href="../Classes/MPSImage.html">MPSImage</a> to use as the source images for the filter.</p></td>
					</tr>
				
					<tr>
						<th scope="row" class="argument-name"><code>convolutionState</code></th>
						<td><p>A valid <a href="../Classes/MPSCNNConvolutionState.html">MPSCNNConvolutionState</a> from the MPSCNNConvoluton counterpart to this MPSCNNConvolutionTranspose.
If there is no forward convolution counterpart, pass NULL here. This state affects the sizing
the result.</p></td>
					</tr>
				
				</table>
			</div>
			

			
			<div class="method-subsection return">
				<h4 class="method-subtitle parameter-title">Return Value</h4>
				<p>A <a href="../Classes/MPSImage.html">MPSImage</a> or <a href="../Classes/MPSTemporaryImage.html">MPSTemporaryImage</a> allocated per the destinationImageAllocator containing the output of the graph.
The offset property will be adjusted to reflect the offset used during the encode.
The returned image will be automatically released when the command buffer completes. If you want to
keep it around for longer, retain the image. (ARC will do this for you if you use it later.)</p>
			</div>
			

			

			
			<div class="method-subsection discussion-section">
				<h4 class="method-subtitle">Discussion</h4>
				<p>In the first iteration on this method, encodeToCommandBuffer:sourceImage:destinationImage:
some work was left for the developer to do in the form of correctly setting the offset property
and sizing the result buffer. With the introduction of the padding policy (see padding property)
the filter can do this work itself. If you would like to have some input into what sort of <a href="../Classes/MPSImage.html">MPSImage</a>
(e.g. temporary vs. regular) or what size it is or where it is allocated, you may set the
destinationImageAllocator to allocate the image yourself.</p>

<p>This method uses the <a href="../Protocols/MPSNNPadding.html">MPSNNPadding</a> padding property to figure out how to size
the result image and to set the offset property. See discussion in MPSNeuralNetworkTypes.h.</p>

<p>Note: the regular encodeToCommandBuffer:sourceImage: method may be used when no state is needed,
such as when the convolution transpose operation is not balanced by a matching convolution object upstream.</p>
			</div>
			

			

			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">MPSCNNConvolution.h</code></p>
			</div>
			
			
		</div>
	</div>
</div>
						</div>
						
					</div>
					
					

                    
                    
          
				</main>

				<footer>
					<div class="footer-copyright">
						
						<p class="copyright">Copyright &copy; 2018 Apple Inc. All rights reserved. Updated: 2018-03-06</p>
						
						
						<p class="generator">Generated by <a href="http://appledoc.gentlebytes.com">appledoc 2.2.1 (build 1334)</a>.</p>
						
					</div>
				</footer>
			</div>
		</div>
	</article>

	<script src="../js/script.js"></script>
</body>
</html>