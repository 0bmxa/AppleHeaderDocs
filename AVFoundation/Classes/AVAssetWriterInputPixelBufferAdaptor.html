<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">

	<title>AVAssetWriterInputPixelBufferAdaptor Class Reference</title>

	<link rel="stylesheet" href="../css/style.css">
	<meta name="viewport" content="initial-scale=1, maximum-scale=1.4">
	<meta name="generator" content="appledoc 2.2.1 (build 1334)">
</head>
<body class="appledoc">
	<header>
		<div class="container" class="hide-in-xcode">
			
			<h1 id="library-title">
				<a href="../index.html">MacOSX 10.13 AVFoundation Framework </a>
			</h1>

			<p id="developer-home">
				<a href="../index.html">Apple Inc.</a>
			</p>
			
		</div>
	</header>

	<aside>
		<div class="container">
			<nav>
				<ul id="header-buttons" role="toolbar">
					<li><a href="../index.html">Index</a></li>
<li><a href="../hierarchy.html">Hierarchy</a></li>

					<li id="on-this-page" role="navigation">
						<label>
							On This Page

							<div class="chevron">
								<div class="chevy chevron-left"></div>
								<div class="chevy chevron-right"></div>
							</div>

							<select id="jump-to">
	<option value="top">Jump To&#133;</option>
	
	<option value="overview">Overview</option>
	

	
	
	<option value="tasks">Tasks</option>
	
	

	
	
	<optgroup label="Properties">
		
		<option value="//api/name/assetWriterInput">assetWriterInput</option>
		
		<option value="//api/name/pixelBufferPool">pixelBufferPool</option>
		
		<option value="//api/name/sourcePixelBufferAttributes">sourcePixelBufferAttributes</option>
		
	</optgroup>
	

	
	<optgroup label="Class Methods">
		
		<option value="//api/name/assetWriterInputPixelBufferAdaptorWithAssetWriterInput:sourcePixelBufferAttributes:">+ assetWriterInputPixelBufferAdaptorWithAssetWriterInput:sourcePixelBufferAttributes:</option>
		
	</optgroup>
	

	
	<optgroup label="Instance Methods">
		
		<option value="//api/name/appendPixelBuffer:withPresentationTime:">- appendPixelBuffer:withPresentationTime:</option>
		
		<option value="//api/name/initWithAssetWriterInput:sourcePixelBufferAttributes:">- initWithAssetWriterInput:sourcePixelBufferAttributes:</option>
		
	</optgroup>
	
	
</select>
						</label>
					</li>
				</ul>
			</nav>
		</div>
	</aside>

	<article>
		<div id="overview_contents" class="container">
			<div id="content">
				<main role="main">
					<h1 class="title">AVAssetWriterInputPixelBufferAdaptor Class Reference</h1>

					
					<div class="section section-specification"><table cellspacing="0"><tbody>
						<tr>
	<th>Inherits from</th>
	<td>NSObject</td>
</tr><tr>
	<th>Declared in</th>
	<td>AVAssetWriterInput.h</td>
</tr>
						</tbody></table></div>
					

                    
					
					<div class="section section-overview">
						<a title="Overview" name="overview"></a>
						<h2 class="subtitle subtitle-overview">Overview</h2>
						<p>@class AVAssetWriterInputPixelBufferAdaptor
@abstract
    Defines an interface for appending video samples packaged as CVPixelBuffer objects to a single <a href="../Classes/AVAssetWriterInput.html">AVAssetWriterInput</a> object.</p>

<p>@discussion
    Instances of AVAssetWriterInputPixelBufferAdaptor provide a CVPixelBufferPool that can be used to allocate pixel buffers for writing to the output file.  Using the provided pixel buffer pool for buffer allocation is typically more efficient than appending pixel buffers allocated using a separate pool.</p>
					</div>
					
					

					
					
					<div class="section section-tasks">
						<a title="Tasks" name="tasks"></a>
						

						
						

						<div class="task-list">
							<div class="section-method">
	<a name="//api/name/assetWriterInputPixelBufferAdaptorWithAssetWriterInput:sourcePixelBufferAttributes:" title="assetWriterInputPixelBufferAdaptorWithAssetWriterInput:sourcePixelBufferAttributes:"></a>
	<h3 class="method-title"><code><a href="#//api/name/assetWriterInputPixelBufferAdaptorWithAssetWriterInput:sourcePixelBufferAttributes:">+&nbsp;assetWriterInputPixelBufferAdaptorWithAssetWriterInput:sourcePixelBufferAttributes:</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<p>@method assetWriterInputPixelBufferAdaptorWithAssetWriterInput:sourcePixelBufferAttributes:
@abstract
    Creates a new pixel buffer adaptor to receive pixel buffers for writing to the output file.</p>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>+ (instancetype)assetWriterInputPixelBufferAdaptorWithAssetWriterInput:(AVAssetWriterInput *)<em>input</em> sourcePixelBufferAttributes:(nullable NSDictionary&lt;NSString*,id&gt; *)<em>sourcePixelBufferAttributes</em></code></div>

		    
			

			

			

			
			<div class="method-subsection discussion-section">
				<h4 class="method-subtitle">Discussion</h4>
				<p>@method assetWriterInputPixelBufferAdaptorWithAssetWriterInput:sourcePixelBufferAttributes:
@abstract
    Creates a new pixel buffer adaptor to receive pixel buffers for writing to the output file.</p>

<p>@param input
    An instance of AVAssetWriterInput to which the receiver should append pixel buffers.  Currently, only asset writer inputs that accept media data of type AVMediaTypeVideo can be used to initialize a pixel buffer adaptor.
@param sourcePixelBufferAttributes
    Specifies the attributes of pixel buffers that will be vended by the input&rsquo;s CVPixelBufferPool.
@result
    An instance of AVAssetWriterInputPixelBufferAdaptor.</p>

<p>@discussion
    In order to take advantage of the improved efficiency of appending buffers created from the adaptor&rsquo;s pixel buffer pool, clients should specify pixel buffer attributes that most closely accommodate the source format of the video frames being appended.</p>

<pre><code>Pixel buffer attributes keys for the pixel buffer pool are defined in &lt;CoreVideo/CVPixelBuffer.h&gt;. To specify the pixel format type, the pixelBufferAttributes dictionary should contain a value for kCVPixelBufferPixelFormatTypeKey.  For example, use [NSNumber numberWithInt:kCVPixelFormatType_32BGRA] for 8-bit-per-channel BGRA. See the discussion under appendPixelBuffer:withPresentationTime: for advice on choosing a pixel format.

Clients that do not need a pixel buffer pool for allocating buffers should set sourcePixelBufferAttributes to nil.

It is an error to initialize an instance of AVAssetWriterInputPixelBufferAdaptor with a sample buffer input that is already attached to another instance of AVAssetWriterInputPixelBufferAdaptor.
</code></pre>
			</div>
			

			

			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">AVAssetWriterInput.h</code></p>
			</div>
			
			
		</div>
	</div>
</div><div class="section-method">
	<a name="//api/name/initWithAssetWriterInput:sourcePixelBufferAttributes:" title="initWithAssetWriterInput:sourcePixelBufferAttributes:"></a>
	<h3 class="method-title"><code><a href="#//api/name/initWithAssetWriterInput:sourcePixelBufferAttributes:">&ndash;&nbsp;initWithAssetWriterInput:sourcePixelBufferAttributes:</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<p>@method initWithAssetWriterInput:sourcePixelBufferAttributes:
@abstract
    Creates a new pixel buffer adaptor to receive pixel buffers for writing to the output file.</p>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>- (instancetype)initWithAssetWriterInput:(AVAssetWriterInput *)<em>input</em> sourcePixelBufferAttributes:(nullable NSDictionary&lt;NSString*,id&gt; *)<em>sourcePixelBufferAttributes</em></code></div>

		    
			

			

			

			
			<div class="method-subsection discussion-section">
				<h4 class="method-subtitle">Discussion</h4>
				<p>@method initWithAssetWriterInput:sourcePixelBufferAttributes:
@abstract
    Creates a new pixel buffer adaptor to receive pixel buffers for writing to the output file.</p>

<p>@param input
    An instance of AVAssetWriterInput to which the receiver should append pixel buffers.  Currently, only asset writer inputs that accept media data of type AVMediaTypeVideo can be used to initialize a pixel buffer adaptor.
@param sourcePixelBufferAttributes
    Specifies the attributes of pixel buffers that will be vended by the input&rsquo;s CVPixelBufferPool.
@result
    An instance of AVAssetWriterInputPixelBufferAdaptor.</p>

<p>@discussion
    In order to take advantage of the improved efficiency of appending buffers created from the adaptor&rsquo;s pixel buffer pool, clients should specify pixel buffer attributes that most closely accommodate the source format of the video frames being appended.</p>

<pre><code>Pixel buffer attributes keys for the pixel buffer pool are defined in &lt;CoreVideo/CVPixelBuffer.h&gt;. To specify the pixel format type, the pixelBufferAttributes dictionary should contain a value for kCVPixelBufferPixelFormatTypeKey.  For example, use [NSNumber numberWithInt:kCVPixelFormatType_32BGRA] for 8-bit-per-channel BGRA. See the discussion under appendPixelBuffer:withPresentationTime: for advice on choosing a pixel format.

Clients that do not need a pixel buffer pool for allocating buffers should set sourcePixelBufferAttributes to nil.

It is an error to initialize an instance of AVAssetWriterInputPixelBufferAdaptor with an asset writer input that is already attached to another instance of AVAssetWriterInputPixelBufferAdaptor.  It is also an error to initialize an instance of AVAssetWriterInputPixelBufferAdaptor with an asset writer input whose asset writer has progressed beyond AVAssetWriterStatusUnknown.
</code></pre>
			</div>
			

			

			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">AVAssetWriterInput.h</code></p>
			</div>
			
			
		</div>
	</div>
</div><div class="section-method">
	<a name="//api/name/assetWriterInput" title="assetWriterInput"></a>
	<h3 class="method-title"><code><a href="#//api/name/assetWriterInput">&nbsp;&nbsp;assetWriterInput</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<p>@property assetWriterInput
@abstract
    The asset writer input to which the receiver should append pixel buffers.</p>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>@property (nonatomic, readonly) AVAssetWriterInput *assetWriterInput</code></div>

		    
			

			

			

			
			<div class="method-subsection discussion-section">
				<h4 class="method-subtitle">Discussion</h4>
				<p>@property assetWriterInput
@abstract
    The asset writer input to which the receiver should append pixel buffers.</p>
			</div>
			

			

			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">AVAssetWriterInput.h</code></p>
			</div>
			
			
		</div>
	</div>
</div><div class="section-method">
	<a name="//api/name/sourcePixelBufferAttributes" title="sourcePixelBufferAttributes"></a>
	<h3 class="method-title"><code><a href="#//api/name/sourcePixelBufferAttributes">&nbsp;&nbsp;sourcePixelBufferAttributes</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<p>@property sourcePixelBufferAttributes
@abstract
    The pixel buffer attributes of pixel buffers that will be vended by the receiver&rsquo;s CVPixelBufferPool.</p>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>@property (nonatomic, readonly, nullable) NSDictionary&lt;NSString*id&gt; *sourcePixelBufferAttributes</code></div>

		    
			

			

			

			
			<div class="method-subsection discussion-section">
				<h4 class="method-subtitle">Discussion</h4>
				<p>@property sourcePixelBufferAttributes
@abstract
    The pixel buffer attributes of pixel buffers that will be vended by the receiver&rsquo;s CVPixelBufferPool.</p>

<p>@discussion
    The value of this property is a dictionary containing pixel buffer attributes keys defined in &lt;CoreVideo/CVPixelBuffer.h>.</p>
			</div>
			

			

			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">AVAssetWriterInput.h</code></p>
			</div>
			
			
		</div>
	</div>
</div><div class="section-method">
	<a name="//api/name/pixelBufferPool" title="pixelBufferPool"></a>
	<h3 class="method-title"><code><a href="#//api/name/pixelBufferPool">&nbsp;&nbsp;pixelBufferPool</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<p>@property pixelBufferPool
@abstract
    A pixel buffer pool that will vend and efficiently recycle CVPixelBuffer objects that can be appended to the receiver.</p>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>@property (nonatomic, readonly, nullable) CVPixelBufferPoolRef pixelBufferPool</code></div>

		    
			

			

			

			
			<div class="method-subsection discussion-section">
				<h4 class="method-subtitle">Discussion</h4>
				<p>@property pixelBufferPool
@abstract
    A pixel buffer pool that will vend and efficiently recycle CVPixelBuffer objects that can be appended to the receiver.</p>

<p>@discussion
    For maximum efficiency, clients should create CVPixelBuffer objects for appendPixelBuffer:withPresentationTime: by using this pool with the CVPixelBufferPoolCreatePixelBuffer() function.</p>

<pre><code>The value of this property will be NULL before [AVAssetWriter startWriting] is called on the associated AVAssetWriter object.

This property is key value observable.
</code></pre>
			</div>
			

			

			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">AVAssetWriterInput.h</code></p>
			</div>
			
			
		</div>
	</div>
</div><div class="section-method">
	<a name="//api/name/appendPixelBuffer:withPresentationTime:" title="appendPixelBuffer:withPresentationTime:"></a>
	<h3 class="method-title"><code><a href="#//api/name/appendPixelBuffer:withPresentationTime:">&ndash;&nbsp;appendPixelBuffer:withPresentationTime:</a></code>
</h3>

	<div class="method-info">
		<div class="pointy-thing"></div>

		<div class="method-info-container">
			
			
			<div class="method-subsection brief-description">
				<p>@method appendPixelBuffer:withPresentationTime:
@abstract
    Appends a pixel buffer to the receiver.</p>
			</div>
			
		    

			<div class="method-subsection method-declaration"><code>- (BOOL)appendPixelBuffer:(CVPixelBufferRef)<em>pixelBuffer</em> withPresentationTime:(CMTime)<em>presentationTime</em></code></div>

		    
			

			

			

			
			<div class="method-subsection discussion-section">
				<h4 class="method-subtitle">Discussion</h4>
				<p>@method appendPixelBuffer:withPresentationTime:
@abstract
    Appends a pixel buffer to the receiver.</p>

<p>@param pixelBuffer
    The CVPixelBuffer to be appended.
@param presentationTime
    The presentation time for the pixel buffer to be appended.  This time will be considered relative to the time passed to <a href="../Classes/AVAssetWriter.html#//api/name/startSessionAtSourceTime:">[AVAssetWriter startSessionAtSourceTime:]</a> to determine the timing of the frame in the output file.
@result
    A BOOL value indicating success of appending the pixel buffer. If a result of NO is returned, clients can check the value of <a href="../Classes/AVAssetWriter.html">AVAssetWriter</a>.status to determine whether the writing operation completed, failed, or was cancelled.  If the status is AVAssetWriterStatusFailed, <a href="../Classes/AVAsset.html">AVAsset</a>.error will contain an instance of NSError that describes the failure.</p>

<p>@discussion
    The receiver will retain the CVPixelBuffer until it is done with it, and then release it.  Do not modify a CVPixelBuffer or its contents after you have passed it to this method.</p>

<pre><code>For optimal performance the format of the pixel buffer should match one of the native formats supported by the selected video encoder. Below are some recommendations:

The H.264 encoder natively supports kCVPixelFormatType_420YpCbCr8BiPlanarVideoRange and kCVPixelFormatType_420YpCbCr8BiPlanarFullRange, which should be used with video and full range input respectively. The JPEG encoder on iOS natively supports kCVPixelFormatType_422YpCbCr8FullRange. For other video codecs on OSX, kCVPixelFormatType_422YpCbCr8 is the preferred pixel format for video and is generally the most performant when encoding. If you need to work in the RGB domain then kCVPixelFormatType_32BGRA is recommended on iOS and kCVPixelFormatType_32ARGB is recommended on OSX.

Pixel buffers not in a natively supported format will be converted internally prior to encoding when possible. Pixel format conversions within the same range (video or full) are generally faster than conversions between different ranges.

The ProRes encoders can preserve high bit depth sources, supporting up to 12bits/ch. ProRes 4444 can contain a mathematically lossless alpha channel and it doesn't do any chroma subsampling. This makes ProRes 4444 ideal for quality critical applications. If you are working with 8bit sources ProRes is also a good format to use due to its high image quality. Use either of the recommended pixel formats above. Note that RGB pixel formats by definition have 4:4:4 chroma sampling.

If you are working with high bit depth sources the following yuv pixel formats are recommended when encoding to ProRes: kCVPixelFormatType_4444AYpCbCr16, kCVPixelFormatType_422YpCbCr16, and kCVPixelFormatType_422YpCbCr10. When working in the RGB domain kCVPixelFormatType_64ARGB is recommended. Scaling and color matching are not currently supported when using AVAssetWriter with any of these high bit depth pixel formats. Please make sure that your track's output settings dictionary specifies the same width and height as the buffers you will be appending. Do not include AVVideoScalingModeKey or AVVideoColorPropertiesKey.

Before calling this method, you must ensure that the input that underlies the receiver is attached to an AVAssetWriter via a prior call to -addInput: and that -startWriting has been called on the asset writer.  It is an error to invoke this method before starting a session (via [AVAssetWriter startSessionAtSourceTime:]) or after ending a session (via [AVAssetWriter endSessionAtSourceTime:]).
</code></pre>
			</div>
			

			

			

			
			<div class="method-subsection declared-in-section">
				<h4 class="method-subtitle">Declared In</h4>
				<p><code class="declared-in-ref">AVAssetWriterInput.h</code></p>
			</div>
			
			
		</div>
	</div>
</div>
						</div>
						
					</div>
					
					

                    
                    
          
				</main>

				<footer>
					<div class="footer-copyright">
						
						<p class="copyright">Copyright &copy; 2018 Apple Inc. All rights reserved. Updated: 2018-03-06</p>
						
						
						<p class="generator">Generated by <a href="http://appledoc.gentlebytes.com">appledoc 2.2.1 (build 1334)</a>.</p>
						
					</div>
				</footer>
			</div>
		</div>
	</article>

	<script src="../js/script.js"></script>
</body>
</html>